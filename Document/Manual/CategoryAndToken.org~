






* Category ITER

Example:
 ITER MIX=A2,b=.3,n=3 CONV=1e-5 CONVC=1e-5 NIT=30

---follwings still may have some inconsistency ---



Category MIX controls the mixing scheme used in the iterations
 towards self-consistency in the LM program.  There is a choice
 between the Broyden and Anderson mixing schemes.  Both schemes
 mix in linear combinations of the input and output density
 (recall that in the ASA, P's and Q's are enough to completely
 specify the density) both from the present iteration and prior
 iterations to accelerate convergence to self-consistency (output
 = input).  For Anderson mixing, the mixing beta controls how
 much output and how much input moment is used in the next
 estimate for the moments: Q* = beta*Qout + (1-beta)*Qin.  Here
 Qout and Qin are charges (that is, moments or densities), and
 the "charges" generated by the input "charge" for a sequence of
 prior iterations.  For small systems, you can take beta close to
 one; for large systems charge sloshing becomes a problem and you
 have to do something different.  Possible choices need to take
 beta much smaller.  See slatsm/amix.f for a description of the
 Anderson mixing scheme, and how it chooses the linear
 combination of prior iterations in the mix.

 The syntax for Anderson mixing is

   MODE=A[,b=val]

 where the optional b=val assigns val to beta.

 Broyden mixing uses a more sophisticated procedure, in which it
 tries to build up the Hessian matrix.  It usually works better
 but has more pitfalls than Anderson.  As with Anderson, it uses
 linear mixing in the absence of prior iterations, Q* = beta*Qout
 + (1-beta)*Qin.  Broyden has an additional parameter, wc, that
 controls how much weight is given to prior iterations in the mix
 (see below).  The syntax for Broyden mixing is

   MODE=B[,b=val][,wc=val]

 There are other switches available to handle more complex cases.
 You can change the name of the mixing file, kill the mixing file
 after a number of iterations, and change to a different set of
 mixing parameters after a specified number of iterations.  The
 most general syntax is
   MODE=parm-set-1[;parm-set-2;parm-set-3...]
 Each parm-set has a general syntax:

   A[nmix][,b=beta][,n=nit][,fn=fnam][,k=nkill][,w=w1,w2][,wa=wa][,bv=betv]  or
   B[nmix][,b=beta][,wc=wc][,n=nit][,fn=fnam][,k=nkill][,w=w1,w2][,wa=wa][,bv=betv]
   (NB: additional parm [,r=rmscst] for constrained mixing)

 The optional parameters (b=, wc=, etc) may occur in any order.

 These parameters are as follows.  Fortran routine parmxp.f parses
 the MODE line to read the parameters, and pqmix.f does
 the mixing.

   nmix: maximum number of prior iterations to include in the mix
         (the mixing file may contain more than nmix prior
         iterations.)  NB: nmix=0 implies linear mixing.

   beta: the mixing beta (see above)

   betv: (when XIPMX=t): the Madelung potential as generated from
         the mixed moments is damped out.  This is done by taking
         using instead of this potential V = (1-betv) V_prior +
         betv V_rhomixed; see XIPMX below.

   nit:  the number of iterations to use mix with this set of
         parameters before passing on to the next set. After the
         last set is exhausted, it starts over with the first
         set.

   fnam: change the mixing file name (mixm is the default).
         Must be four characters or fewer.

   nkill:kill mixing file after nkill iterations.  This is
         occasionally helpful when the mixing runs out of steam,
         or when the mixing parameters change.

   wc:   (Broyden only) that controls how much weight is given to
         prior iterations in estimating the Jacobian.  wc=1 is
         fairly conservative.  Choosing wc<0 assigns a floating
         value to wc, equal to -wc-input/rms-err.  This increases
         wc as the error becomes small.

   w1,w2 (spin-polarized calculations only) pqmix mixes the sum
         (up+down) and difference (up-down) of the two spin
         channels.  They are weighted by w1 and w2 in the mixing,
         more heavily emphasizing the more heavily weighted.  As
         special cases, w1=0 freezes the charge and mixes the
         magnetic moments only w2=0 freezes the moments and mixes
         the charge only

   wa:   weight for extra quantities included with P,Q in the
         mixing procedure.  For noncollinear magnetism, includes
         the Euler angles.  For nonspherical density, includes
         the qpp.  As special cases, any one or two of w1,w2 and
         wa may be zero.  A zero weight freezes the values
         corresponding to those weights.

   Example: ITERE=B30,n=8,w=2,1,fn=mxm,wc=11,k=3;A2,b=1

   does 8 iterations of Broyden mixing, followed by Anderson mixing
   The Broyden iterations weight the (up+down) double that of
   (up-down) for the spin pol case, and iterations are saved in a file
   which is deleted at the end of every third iteration.  WC is 11.
   beta assumes the default value.
   The Anderson iterations mix two prior iterations with beta of 1.


